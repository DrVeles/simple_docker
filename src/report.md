# Simple Docker

Введение в докер. Разработка простого докер-образа для собственного сервера.

## Part 1. Готовый докер
##### Пуллим, запускаем и смотрим информацию nginx контейнере 
![Alt](./misc/part1/Pasted%20image%2020240722144200.png)
Смотрим размер контейнера:
![Alt](./misc/part1/Pasted%20image%2020240722145029.png)
Замапленные порты:
![Alt](./misc/part1/Pasted%20image%2020240722144815.png)
Ip контейнера:
![Alt](./misc/part1/Pasted%20image%2020240722144305.png)
##### Останавливаем и запускаем контейнер с портами 80 и 443:
![Alt](./misc/part1/Pasted%20image%2020240722145958.png)
##### Проверяем что в браузере доступен контейнер с **nginx**.
![Alt](./misc/part1/Pasted%20image%2020240722145853.png)
##### Перезапускаем докер контейнер через `docker restart container_name`.
![Alt](./misc/part1/Pasted%20image%2020240722150234.png)
  

## Part 2. Операции с контейнером


##### Читаем конфигурационный файл *nginx.conf* внутри докер контейнера через команду *exec*.
![](misc/part2/Pasted%20image%2020240722151150.png)
##### Создаем на локальной машине файл *nginx.conf* и настраиваем в нем по пути */status* отдачу страницы статуса сервера **nginx**.
![](misc/part2/Pasted%20image%2020240722152131.png)
##### Копируем созданный файл *nginx.conf* внутрь докер-образа через команду `docker cp`.
![](misc/part2/Pasted%20image%2020240722151846.png)
##### Перезапускаем **nginx** внутри докер-образа через команду *exec*.
![](misc/part2/Pasted%20image%2020240722152003.png)
##### Проверяем, что по адресу *localhost:80/status* отдается страничка со статусом сервера **nginx**.
![](misc/part2/Pasted%20image%2020240722152302.png)
##### Экспортируем контейнер в файл *container* через команду *export*.
![](misc/part2/Pasted%20image%2020240722152635.png)
##### Останавливаем контейнер.
![](misc/part2/Pasted%20image%2020240722152848.png)
##### Удаляем образ и остановленный контейнер.
![](misc/part2/Pasted%20image%2020240722153018.png)
##### Импортируем и запускаем контейнер.
![](misc/part2/Pasted%20image%2020240722153425.png)
##### Проверяем, что по адресу *localhost:80/status* отдается страничка со статусом сервера **nginx**.
![](misc/part2/Pasted%20image%2020240722153519.png)

## Part 3. Мини веб-сервер
##### Пишем мини-сервер на **C** и **FastCgi**, который будет возвращать простейшую страничку с надписью `Hello World!`.
![](misc/part3/Pasted%20image%2020240724163036.png)
##### Пишем свой *nginx.conf*, который будет проксировать все запросы с 81 порта на *127.0.0.1:8080*.
![](misc/part3/Pasted%20image%2020240724163022.png)
##### Запускаем написанный мини-сервер через *spawn-fcgi* на порту 8080.
![](misc/part3/Pasted%20image%2020240724162007.png)
![](misc/part3/Pasted%20image%2020240724162524.png)

##### Проверяем, что в браузере по *localhost:81* отдается написанная страничка.
![](misc/part4/Pasted%20image%2020240724182102.png)

##### Сохраняем файл *nginx.conf* по пути *./server/nginx.conf*.
При необходимости передаем в контейнер:
![](misc/part3/Pasted%20image%2020240724161805.png)


## Part 4. Свой докер

#### Пишем свой докер-образ, который сам собирает и поднимает сервер из 3 части:
![](misc/part4/Pasted%20image%2020240724182241.png)
![](misc/part4/Pasted%20image%2020240724182208.png)
##### Собираем написанный докер-образ через `docker build` при этом указав имя и тег.
![](misc/part4/Pasted%20image%2020240724181815.png)
##### Проверяем через `docker images`, что все собралось корректно.
![](misc/part4/Pasted%20image%2020240724181837.png)
##### Запускаем собранный докер-образ с маппингом 81 порта на 80 на локальной машине и маппингом папки *./nginx* внутрь контейнера по адресу, где лежат конфигурационные файлы **nginx**'а.
![](misc/part4/Pasted%20image%2020240724182432.png)
##### Проверяем, что по localhost:80 доступна страничка написанного мини сервера.
![](misc/part4/Pasted%20image%2020240724182446.png)
##### Дописываем в *./server/nginx.conf* проксирование странички */status*, по которой надо отдавать статус сервера **nginx**.
![](misc/part4/Pasted%20image%2020240724182651.png)
##### Перезапускаем nginx внутри докер-контейнера.
![](misc/part4/Pasted%20image%2020240724182636.png)
##### Проверяем, что теперь по *localhost:80/status* отдается страничка со статусом **nginx**
![](misc/part4/Pasted%20image%2020240724182826.png)

## Part 5. **Dockle**

##### Сканируем образ из предыдущего задания через `dockle [image_id|repository]`.
##### Исправляем образ так, чтобы при проверке через **dockle** не было ошибок и предупреждений.

## Part 6. Базовый **Docker Compose**

##### Пишем файл *docker-compose.yml*, который поднимет отдельно server и nginx и свяжет их портами.
![](misc/part6/Pasted%20image%2020240724202143.png)
##### Собираем и запускаем проект с помощью команды `docker-compose up --build`. 
![](misc/part6/Pasted%20image%2020240724202007.png)
##### Проверяем, что в браузере по *localhost:80* отдается страничка, как и ранее.
![](misc/part6/Pasted%20image%2020240724202100.png)